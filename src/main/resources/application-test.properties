# -------------------------------------------------
# Test profile ? application-test.properties
# -------------------------------------------------

# Give the test instance a distinct name (optional)
spring.application.name=batcher-test

# -----------------------------------------------------------------
# In?memory database (H2) ? fast, isolated, no external service needed
# -----------------------------------------------------------------
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# -----------------------------------------------------------------
# JPA / Hibernate ? keep schema creation simple for tests
# -----------------------------------------------------------------
# `create-drop` creates the schema at startup and drops it when the
# context shuts down ? perfect for unit / integration tests.
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true               # useful when debugging tests
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# -----------------------------------------------------------------
# Flyway ? usually disabled for pure unit tests; enable if you want
# migrations applied to the H2 DB.
# -----------------------------------------------------------------
spring.flyway.enabled=false   # set true if you need migrations in tests
# spring.flyway.locations=classpath:db/migration   # keep same location

# -----------------------------------------------------------------
# Batch configuration ? keep the same values unless you need to tweak
# -----------------------------------------------------------------
batch.chunk-size=1000
customise.link.suffix=?source=batcher

# -----------------------------------------------------------------
# JWT ? use a static secret for deterministic test results
# -----------------------------------------------------------------
jwt.secret=TestJwtSecretKeyChangeMe
jwt.expiry-time=600000   # 10 minutes ? same as prod, adjust if needed
